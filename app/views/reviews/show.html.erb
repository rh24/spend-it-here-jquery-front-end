<h2><%= @review.title %></h2>

<div id="review-<%= @review.id %>">
  <%= @review.content %><br /><br />
  <%= display_rating @review %><br />

  <% # DRY code. Separate if statement below into helper? %>
  <% if @review.would_recommend %>
    <p><%= "#{display_email @review} recommends this business." %></p>
  <% else %>
    <p><%= @review.user.email %> does not recommend this business.</p>
  <% end %>

  <p>User paid in <%= @review.crypto.name %>.</p>
</div><br />

<%# render 'comments/new', :review => @review %>
<button id="comment-btn">Add Comment</button>
<a id="load-comments" href="#">Load Comments</a>
<div id="comment-section" data-review-id="<%= @review.id %>" data-business-id="<%= @review.business_id %>">
  <div class="content">
    <div class="user" data-id="<%= current_user.id %>">

    </div>
  </div>
</div>

<%= display_edit_link @review %> |
<%= display_delete_link @review %> |
<%= display_all_link @review %>

<script type="text/javascript">
  $(function () {
    $('#comment-btn').on('click', function () {
      $('#comment-section').append(`
        <%= form_for @comment, url: biz_review_comments_path(@review.business, @review), method: :post do |f| %>
        <%= f.text_area :content %>
        <%= f.hidden_field :business_id, :value => @review.business.id %>
        <%= f.hidden_field :review_id, :value => @review.id %>
        <%= f.hidden_field :user_id, :value => current_user.id %>
        <%= f.submit %>
        <% end %>`)
    })

    getComment();
  })

  let $businessId = $('#comment-section').data("business-id");
  let $reviewId = $('#comment-section').data("review-id");
  function getComment() {
    $.get(`/businesses/${$businessId}/reviews/${$reviewId}/comments`, function (data) {
      debugger;
    });

    displayComment();
  }

  function displayComment() {
    $('#comment-section').append("Hello")
  }
</script>
